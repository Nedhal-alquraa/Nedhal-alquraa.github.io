<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¶Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡ - ØªØ­Ø¯ÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif, 'Arial Unicode MS';
            background: linear-gradient(135deg, #6879e3 0%, #754fa7 100%);
            color: white;
            min-height: 100vh;
            line-height: 1.6;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px 0;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            white-space: nowrap;
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-title {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffffff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .participant-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .participant-card:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .participant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .participant-name {
            font-size: 1.3em;
            font-weight: bold;
        }

        .participant-rank {
            background: linear-gradient(45deg, #6879e3, #754fa7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .participant-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 1.4em;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .stat-title {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
        }

        .error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.5);
            color: #ff6b6b;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .update-status {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            backdrop-filter: blur(10px);
            z-index: 999;
            transition: all 0.3s ease;
        }

        .countdown-card {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .countdown-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .elimination-card {
            background: linear-gradient(135deg, #ff4757 0%, #c44569 100%);
            border: 2px solid #ff3838;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 71, 87, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0); }
        }

        .season-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .season-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .records-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .records-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            color: #ffd700;
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #ffd700;
        }

        .medal {
            font-size: 1.5em;
            margin-left: 10px;
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }

            .nav-buttons {
                justify-content: center;
            }

            .page-title {
                font-size: 2em;
            }

            .participant-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .season-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                ğŸ“š Ù†Ø¶Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡
            </div>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showPage('current-results')">Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</button>
                <button class="nav-btn" onclick="showPage('elimination-countdown')">Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø±Ø¯</button>
                <button class="nav-btn" onclick="showPage('elimination-list')">Ø§Ù„Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ù„Ù„Ø·Ø±Ø¯</button>
                <button class="nav-btn" onclick="showPage('season-comparison')">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙˆØ§Ø³Ù…</button>
                <button class="nav-btn" onclick="showPage('records')">Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©</button>
                <button class="nav-btn" onclick="showPage('overall-results')">Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</button>
            </div>
        </div>
    </nav>

    <!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« -->
    <div id="update-status" class="update-status" style="display: none;">
        ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
    </div>

    <div class="container">
        <!-- ØµÙØ­Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
        <div id="current-results" class="page active">
            <h1 class="page-title">ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ© - Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø¬Ø§Ø±ÙŠ</h1>
            
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-participants">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-ideas">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙÙƒØ§Ø±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-hours">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="current-season">1</div>
                    <div class="stat-label">Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                </div>
            </div>

            <!-- Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ - ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø± -->
            <div class="chart-container">
                <h2 style="text-align: center; margin-bottom: 20px;">ğŸ† ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø­Ø³Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙÙƒØ§Ø±</h2>
                <canvas id="ideas-chart" width="400" height="200"></canvas>
            </div>

            <!-- Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ - ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© -->
            <div class="chart-container">
                <h2 style="text-align: center; margin-bottom: 20px;">ğŸ”¥ ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©</h2>
                <canvas id="streak-chart" width="400" height="200"></canvas>
            </div>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© -->
            <div id="participants-list">
                <div class="loading">ğŸ“¥ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø±Ø¯ -->
        <div id="elimination-countdown" class="page">
            <h1 class="page-title">â° Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø±Ø¯</h1>
            <p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; opacity: 0.9;">
                Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø±Ø¯ Ù„ÙƒÙ„ Ù…Ø´Ø§Ø±Ùƒ
            </p>
            <div id="countdown-list">
                <div class="loading">â³ Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª...</div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ù„Ù„Ø·Ø±Ø¯ -->
        <div id="elimination-list" class="page">
            <h1 class="page-title">ğŸš¨ Ø§Ù„Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ù„Ù„Ø·Ø±Ø¯</h1>
            <p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; opacity: 0.9;">
                Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ø§Ø³ØªÙˆÙÙˆØ§ Ø´Ø±ÙˆØ· Ø§Ù„Ø·Ø±Ø¯ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± 5 Ø£ÙŠØ§Ù…
            </p>
            <div id="elimination-candidates">
                <div class="loading">ğŸ” Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø´Ø±ÙˆØ· Ø§Ù„Ø·Ø±Ø¯...</div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙˆØ§Ø³Ù… -->
        <div id="season-comparison" class="page">
            <h1 class="page-title">ğŸ“ˆ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙˆØ§Ø³Ù…</h1>
            
            <!-- Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© -->
            <div class="chart-container">
                <h2 style="text-align: center; margin-bottom: 20px;">ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙˆØ§Ø³Ù…</h2>
                <canvas id="seasons-chart" width="400" height="200"></canvas>
            </div>

            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ø³Ù… -->
            <div id="seasons-stats" class="season-comparison">
                <div class="loading">ğŸ“Š Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ø³Ù…...</div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© -->
        <div id="records" class="page">
            <h1 class="page-title">ğŸ… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©</h1>
            
            <!-- Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ -->
            <div class="records-section">
                <div class="records-title">ğŸŒŸ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                <div id="current-season-records">
                    <div class="loading">ğŸ† Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©...</div>
                </div>
            </div>

            <!-- Ø£Ø±Ù‚Ø§Ù… Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù… -->
            <div class="records-section">
                <div class="records-title">ğŸ‘‘ Ø£Ø±Ù‚Ø§Ù… Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…</div>
                <div id="all-time-records">
                    <div class="loading">ğŸ“š Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©...</div>
                </div>
            </div>
        </div>

        <!-- ØµÙØ­Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© -->
        <div id="overall-results" class="page">
            <h1 class="page-title">ğŸ“‹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</h1>
            <p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; opacity: 0.9;">
                Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…
            </p>

            <!-- Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
            <div class="chart-container">
                <h2 style="text-align: center; margin-bottom: 20px;">ğŸ“Š Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø±</h2>
                <canvas id="overall-chart" width="400" height="200"></canvas>
            </div>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© -->
            <div id="overall-participants-list">
                <div class="loading">ğŸ“Š Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©...</div>
            </div>
        </div>
    </div>

    <script src="names.js"></script>
    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª API
        const API_CONFIG = {
            key: 'AIzaSyBjycpwQVemlyKbAgbk8dpANkFp_cAUJ-w',
            spreadsheetId: '12_XBxWzv7xk8B-qIokzZfemY8YQTI8yRF9l8AO9fFKc',
            sheetName: 'Ø§Ù„Ø­ØµØ§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ',
            range: 'Ø§Ù„Ø­ØµØ§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ!A:D'
        };

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let appData = {
            rawData: [],
            participants: new Map(),
            seasons: [],
            currentSeason: 1,
            lastUpdate: null
        };

        // Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ Ù„Ù„Ù‡Ø¬Ø±ÙŠ (Ù…Ø¨Ø³Ø·Ø©)
        function gregorianToHijri(date) {
            const g = new Date(date);
            const gYear = g.getFullYear();
            const gMonth = g.getMonth() + 1;
            const gDay = g.getDate();
            
            // ØªØ­ÙˆÙŠÙ„ ØªÙ‚Ø±ÙŠØ¨ÙŠ - ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù†Ø­ØªØ§Ø¬ Ù…ÙƒØªØ¨Ø© Ø¯Ù‚ÙŠÙ‚Ø©
            const hYear = Math.floor(gYear - 579);
            const hMonth = Math.floor(((gYear - 1970) * 12 + gMonth) % 12) + 1;
            const hDay = gDay;
            
            return { year: hYear, month: hMonth, day: hDay };
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ù‡Ø¬Ø±ÙŠ
        function calculateSeason(date) {
            const hijri = gregorianToHijri(date);
            return hijri.month; // Ù…Ø¨Ø³Ø·: ÙƒÙ„ Ø´Ù‡Ø± Ù‡Ø¬Ø±ÙŠ = Ù…ÙˆØ³Ù…
        }

        // Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ø¥Ù„Ù‰ Ø¯Ù‚Ø§Ø¦Ù‚
        function timeToMinutes(timeString) {
            if (!timeString || timeString === '0') return 0;
            
            const parts = timeString.split(':');
            const hours = parseInt(parts[0]) || 0;
            const minutes = parseInt(parts[1]) || 0;
            const seconds = parseInt(parts[2]) || 0;
            
            return hours * 60 + minutes + (seconds / 60);
        }

        // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø±
        function calculateIdeas(minutes, extraEvents = []) {
            let ideas = 0;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            if (minutes <= 15) {
                ideas = minutes;
            } else if (minutes <= 30) {
                ideas = 15 + (minutes - 15) * 1.15;
            } else {
                ideas = 15 + (15 * 1.15) + (minutes - 30) * 1.2;
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ÙÙƒØ§Ø± Ù…Ù† Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª
            if (extraEvents) {
                extraEvents.split(',').forEach(event => {
                    const trimmedEvent = event.trim();
                    switch(trimmedEvent) {
                        case 'Ø§Ù„Ù„Ù‚Ø§Ø¡ Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠ':
                            ideas += 60;
                            break;
                        case 'Ø­Ø¶ÙˆØ± Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù†Ù‚Ø§Ø´ÙŠØ©':
                            ideas += 60;
                            break;
                        case 'Ø­Ø¶ÙˆØ± Ø¬Ù„Ø³Ø© ÙƒØªØ¨':
                            ideas += 40;
                            break;
                    }
                });
            }
            
            return Math.round(ideas * 100) / 100;
        }

        // Ø¯Ø§Ù„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets
        async function fetchData() {
            try {
                showUpdateStatus('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                
                // Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Google Sheets Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… CSV export
                const csvUrl = `https://docs.google.com/spreadsheets/d/${API_CONFIG.spreadsheetId}/export?format=csv&gid=773724470`;
                
                let response;
                try {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… API Ø£ÙˆÙ„Ø§Ù‹
                    const apiUrl = `https://sheets.googleapis.com/v4/spreadsheets/${API_CONFIG.spreadsheetId}/values/${API_CONFIG.range}?key=${API_CONFIG.key}`;
                    response = await fetch(apiUrl);
                    
                    if (!response.ok) {
                        throw new Error('API failed, trying CSV');
                    }
                    
                    const data = await response.json();
                    if (!data.values || data.values.length < 2) {
                        throw new Error('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„');
                    }
                    
                    appData.rawData = data.values.slice(1);
                    
                } catch (apiError) {
                    console.log('API failed, trying CSV export...');
                    
                    // Ø¥Ø°Ø§ ÙØ´Ù„ APIØŒ Ø§Ø³ØªØ®Ø¯Ù… CSV export
                    response = await fetch(csvUrl);
                    if (!response.ok) {
                        throw new Error(`ÙØ´Ù„ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${response.status}`);
                    }
                    
                    const csvText = await response.text();
                    const rows = parseCSV(csvText);
                    
                    if (rows.length < 2) {
                        throw new Error('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„');
                    }
                    
                    appData.rawData = rows.slice(1);
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙ†Ø¬Ø­ Ø£ÙŠ Ù…Ù† Ø§Ù„Ø·Ø±Ù‚ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
                if (!appData.rawData.length) {
                    console.log('Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©...');
                    appData.rawData = getSampleData();
                }
                
                processData();
                updateAllPages();
                
                appData.lastUpdate = new Date();
                showUpdateStatus(`Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${appData.lastUpdate.toLocaleTimeString('ar-SA')}`);
                
                setTimeout(() => hideUpdateStatus(), 3000);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                
                // Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙƒØ­Ù„ Ø£Ø®ÙŠØ±
                console.log('Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙƒØ­Ù„ Ø£Ø®ÙŠØ±...');
                appData.rawData = getSampleData();
                processData();
                updateAllPages();
                
                showUpdateStatus('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© - ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„', 'error');
                setTimeout(() => hideUpdateStatus(), 5000);
            }
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ù„ÙŠÙ„ CSV
        function parseCSV(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let line of lines) {
                if (line.trim()) {
                    // ØªØ­Ù„ÙŠÙ„ Ø¨Ø³ÙŠØ· Ù„Ù„Ù€ CSV Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ Ø¯Ø§Ø®Ù„ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³
                    const row = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            row.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    row.push(current.trim());
                    rows.push(row);
                }
            }
            
            return rows;
        }
        
        // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function processData() {
            appData.participants.clear();
            
            appData.rawData.forEach(row => {
                if (row.length < 3) return;
                
                const timestamp = row[0];
                const email = row[1];
                const timeString = row[2];
                const extraEvents = row[3] || '';
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®
                const date = new Date(timestamp);
                const dateKey = date.toDateString();
                const season = calculateSeason(date);
                
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù…
                const name = EMAIL_TO_NAME[email] || email.split('@')[0];
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø£ÙÙƒØ§Ø±
                const minutes = timeToMinutes(timeString);
                const ideas = calculateIdeas(minutes, extraEvents);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ
                if (!appData.participants.has(email)) {
                    appData.participants.set(email, {
                        name: name,
                        email: email,
                        totalIdeas: 0,
                        totalHours: 0,
                        seasonalData: new Map(),
                        readingDays: new Set(),
                        streakData: []
                    });
                }
                
                const participant = appData.participants.get(email);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
                participant.totalIdeas += ideas;
                participant.totalHours += minutes / 60;
                participant.readingDays.add(dateKey);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©
                if (!participant.seasonalData.has(season)) {
                    participant.seasonalData.set(season, {
                        ideas: 0,
                        hours: 0,
                        days: new Set()
                    });
                }
                
                const seasonData = participant.seasonalData.get(season);
                seasonData.ideas += ideas;
                seasonData.hours += minutes / 60;
                seasonData.days.add(dateKey);
            });
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
            calculateStreaks();
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
            appData.currentSeason = Math.max(...Array.from(appData.participants.values())
                .flatMap(p => Array.from(p.seasonalData.keys())));
        }

        // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
        function calculateStreaks() {
            appData.participants.forEach(participant => {
                const sortedDates = Array.from(participant.readingDays)
                    .map(dateStr => new Date(dateStr))
                    .sort((a, b) => a - b);
                
                let currentStreak = 0;
                let maxStreak = 0;
                
                for (let i = 0; i < sortedDates.length; i++) {
                    if (i === 0) {
                        currentStreak = 1;
                    } else {
                        const daysDiff = Math.floor((sortedDates[i] - sortedDates[i-1]) / (1000 * 60 * 60 * 24));
                        if (daysDiff === 1) {
                            currentStreak++;
                        } else {
                            currentStreak = 1;
                        }
                    }
                    
                    maxStreak = Math.max(maxStreak, currentStreak);
                }
                
                participant.currentStreak = currentStreak;
                participant.maxStreak = maxStreak;
            });
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«
        function showUpdateStatus(message, type = 'info') {
            const statusEl = document.getElementById('update-status');
            statusEl.textContent = message;
            statusEl.style.display = 'block';
            
            if (type === 'error') {
                statusEl.style.background = 'rgba(220, 53, 69, 0.9)';
            } else {
                statusEl.style.background = 'rgba(0, 0, 0, 0.8)';
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ø®ÙØ§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«
        function hideUpdateStatus() {
            document.getElementById('update-status').style.display = 'none';
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
        function updateAllPages() {
            updateCurrentResults();
            updateEliminationCountdown();
            updateEliminationList();
            updateSeasonComparison();
            updateRecords();
            updateOverallResults();
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        function updateCurrentResults() {
            const currentSeasonParticipants = Array.from(appData.participants.values())
                .filter(p => p.seasonalData.has(appData.currentSeason))
                .map(p => ({
                    ...p,
                    seasonIdeas: p.seasonalData.get(appData.currentSeason).ideas,
                    seasonHours: p.seasonalData.get(appData.currentSeason).hours,
                    seasonDays: p.seasonalData.get(appData.currentSeason).days.size
                }));
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
            document.getElementById('total-participants').textContent = currentSeasonParticipants.length;
            document.getElementById('total-ideas').textContent = Math.round(currentSeasonParticipants.reduce((sum, p) => sum + p.seasonIdeas, 0));
            document.getElementById('total-hours').textContent = Math.round(currentSeasonParticipants.reduce((sum, p) => sum + p.seasonHours, 0));
            document.getElementById('current-season').textContent = appData.currentSeason;
            
            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙÙƒØ§Ø±
            const sortedByIdeas = [...currentSeasonParticipants].sort((a, b) => b.seasonIdeas - a.seasonIdeas);
            
            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
            const sortedByStreak = [...currentSeasonParticipants].sort((a, b) => (b.currentStreak || 0) - (a.currentStreak || 0));
            
            // Ø±Ø³Ù… Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
            createChart('ideas-chart', sortedByIdeas.slice(0, 10), 'seasonIdeas', 'Ø§Ù„Ø£ÙÙƒØ§Ø±');
            createChart('streak-chart', sortedByStreak.slice(0, 10), 'currentStreak', 'Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©');
            
            // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†
            displayParticipantsList('participants-list', sortedByIdeas);
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        function createChart(canvasId, data, valueKey, label) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            // ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ù† ÙˆØ¬Ø¯
            if (ctx.chart) {
                ctx.chart.destroy();
            }
            
            ctx.chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(p => p.name),
                    datasets: [{
                        label: label,
                        data: data.map(p => p[valueKey] || 0),
                        backgroundColor: 'rgba(104, 121, 227, 0.8)',
                        borderColor: 'rgba(117, 79, 167, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.2)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.2)'
                            }
                        }
                    }
                }
            });
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†
        function displayParticipantsList(containerId, participants) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '';
            
            participants.forEach((participant, index) => {
                html += `
                    <div class="participant-card">
                        <div class="participant-header">
                            <div class="participant-name">${participant.name}</div>
                            <div class="participant-rank">#${index + 1}</div>
                        </div>
                        <div class="participant-stats">
                            <div class="stat-item">
                                <span class="stat-value">${Math.round(participant.seasonIdeas || 0)}</span>
                                <span class="stat-title">Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${Math.round((participant.seasonHours || 0) * 10) / 10}</span>
                                <span class="stat-title">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${participant.currentStreak || 0}</span>
                                <span class="stat-title">Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${participant.seasonDays || 0}</span>
                                <span class="stat-title">Ø£ÙŠØ§Ù… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<div class="error">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</div>';
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø±Ø¯
        function updateEliminationCountdown() {
            const currentSeasonParticipants = Array.from(appData.participants.values())
                .filter(p => p.seasonalData.has(appData.currentSeason))
                .map(p => {
                    const seasonIdeas = p.seasonalData.get(appData.currentSeason).ideas;
                    const daysLeft = Math.max(0, Math.floor(seasonIdeas / 10));
                    return {
                        ...p,
                        seasonIdeas,
                        daysLeft: Math.min(21, daysLeft)
                    };
                })
                .sort((a, b) => a.daysLeft - b.daysLeft);
            
            const container = document.getElementById('countdown-list');
            let html = '';
            
            currentSeasonParticipants.forEach(participant => {
                const isCloseToElimination = participant.daysLeft <= 5;
                html += `
                    <div class="countdown-card ${isCloseToElimination ? 'elimination-card' : ''}">
                        <div class="participant-name" style="margin-bottom: 15px;">${participant.name}</div>
                        <div class="countdown-number">${participant.daysLeft}</div>
                        <div style="font-size: 1.1em;">ÙŠÙˆÙ… Ù…ØªØ¨Ù‚ÙŠ</div>
                        <div style="margin-top: 10px; opacity: 0.8;">
                            Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${Math.round(participant.seasonIdeas)}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<div class="error">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</div>';
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ù„Ù„Ø·Ø±Ø¯
        function updateEliminationList() {
            const now = new Date();
            const fiveDaysAgo = new Date(now.getTime() - 5 * 24 * 60 * 60 * 1000);
            
            const eliminationCandidates = Array.from(appData.participants.values())
                .filter(p => {
                    if (!p.seasonalData.has(appData.currentSeason)) return false;
                    
                    const seasonData = p.seasonalData.get(appData.currentSeason);
                    const seasonIdeas = seasonData.ideas;
                    
                    // Ø´Ø±Ø· Ø§Ù„Ø·Ø±Ø¯: Ø§Ù„Ø£ÙÙƒØ§Ø± ØµÙØ± Ø£Ùˆ Ø£Ù‚Ù„ØŒ Ø£Ùˆ Ø¹Ø¯Ù… ØªØ­Ù‚ÙŠÙ‚ 100 ÙÙƒØ±Ø© Ø¨Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«
                    const isEliminated = seasonIdeas <= 0;
                    const lastReadingDate = Math.max(...Array.from(seasonData.days).map(d => new Date(d).getTime()));
                    const daysSinceLastReading = Math.floor((now.getTime() - lastReadingDate) / (1000 * 60 * 60 * 24));
                    
                    return isEliminated && daysSinceLastReading <= 5;
                })
                .map(p => ({
                    ...p,
                    eliminationReason: p.seasonalData.get(appData.currentSeason).ideas <= 0 ? 'ÙˆØµÙˆÙ„ Ø§Ù„Ø£ÙÙƒØ§Ø± Ù„Ù„ØµÙØ±' : 'Ø¹Ø¯Ù… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰',
                    eliminationDate: new Date() // ØªØ¨Ø³ÙŠØ· - ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù†Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯Ù‚ÙŠÙ‚
                }))
                .sort((a, b) => b.eliminationDate - a.eliminationDate);
            
            const container = document.getElementById('elimination-candidates');
            let html = '';
            
            if (eliminationCandidates.length === 0) {
                html = '<div style="text-align: center; padding: 50px; font-size: 1.2em;">ğŸ‰ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ­Ù‚ÙŠÙ† Ù„Ù„Ø·Ø±Ø¯ Ø­Ø§Ù„ÙŠØ§Ù‹!</div>';
            } else {
                eliminationCandidates.forEach(participant => {
                    html += `
                        <div class="participant-card elimination-card">
                            <div class="participant-header">
                                <div class="participant-name">${participant.name}</div>
                                <div style="background: #ff3838; padding: 8px 15px; border-radius: 20px; font-weight: bold;">
                                    Ù…Ø³ØªØ­Ù‚ Ù„Ù„Ø·Ø±Ø¯
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <div><strong>Ø³Ø¨Ø¨ Ø§Ù„Ø·Ø±Ø¯:</strong> ${participant.eliminationReason}</div>
                                <div><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</strong> ${participant.eliminationDate.toLocaleDateString('ar-SA')}</div>
                                <div><strong>Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> ${Math.round(participant.seasonalData.get(appData.currentSeason).ideas)}</div>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙˆØ§Ø³Ù…
        function updateSeasonComparison() {
            const seasons = [...new Set(Array.from(appData.participants.values())
                .flatMap(p => Array.from(p.seasonalData.keys())))].sort((a, b) => a - b);
            
            const seasonStats = seasons.map(season => {
                const seasonParticipants = Array.from(appData.participants.values())
                    .filter(p => p.seasonalData.has(season));
                
                const totalHours = seasonParticipants.reduce((sum, p) => sum + p.seasonalData.get(season).hours, 0);
                const averageHours = seasonParticipants.length > 0 ? totalHours / seasonParticipants.length : 0;
                
                return {
                    season,
                    participantsCount: seasonParticipants.length,
                    averageHours: Math.round(averageHours * 10) / 10,
                    totalHours: Math.round(totalHours),
                    eliminatedCount: 0 // Ù…Ø¨Ø³Ø· - ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù†Ø­Ø³Ø¨ Ø§Ù„Ù…Ø·Ø±ÙˆØ¯ÙŠÙ†
                };
            });
            
            // Ø±Ø³Ù… Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
            const ctx = document.getElementById('seasons-chart');
            if (ctx) {
                if (ctx.chart) ctx.chart.destroy();
                
                ctx.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: seasonStats.map(s => `Ø§Ù„Ù…ÙˆØ³Ù… ${s.season}`),
                        datasets: [{
                            label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†',
                            data: seasonStats.map(s => s.participantsCount),
                            borderColor: 'rgba(104, 121, 227, 1)',
                            backgroundColor: 'rgba(104, 121, 227, 0.2)',
                            tension: 0.4
                        }, {
                            label: 'Ù…ØªÙˆØ³Ø· Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©',
                            data: seasonStats.map(s => s.averageHours),
                            borderColor: 'rgba(117, 79, 167, 1)',
                            backgroundColor: 'rgba(117, 79, 167, 0.2)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: 'white'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.2)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: 'white'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.2)'
                                }
                            }
                        }
                    }
                });
            }
            
            // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ø³Ù…
            const container = document.getElementById('seasons-stats');
            let html = '';
            
            seasonStats.forEach(stat => {
                html += `
                    <div class="season-card">
                        <h3>Ø§Ù„Ù…ÙˆØ³Ù… ${stat.season}</h3>
                        <div style="margin: 15px 0;">
                            <div><strong>${stat.participantsCount}</strong> Ù…Ø´Ø§Ø±Ùƒ</div>
                            <div><strong>${stat.averageHours}</strong> Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                            <div><strong>${stat.totalHours}</strong> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                            <div><strong>${stat.eliminatedCount}</strong> Ù…Ø·Ø±ÙˆØ¯</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<div class="error">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</div>';
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©
        function updateRecords() {
            // Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
            const currentSeasonParticipants = Array.from(appData.participants.values())
                .filter(p => p.seasonalData.has(appData.currentSeason));
            
            const currentSeasonRecords = calculateRecords(currentSeasonParticipants, true);
            displayRecords('current-season-records', currentSeasonRecords);
            
            // Ø£Ø±Ù‚Ø§Ù… Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…
            const allTimeRecords = calculateRecords(Array.from(appData.participants.values()), false);
            displayRecords('all-time-records', allTimeRecords);
        }

        // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©
        function calculateRecords(participants, seasonOnly) {
            if (participants.length === 0) return {};
            
            // Ø£ÙƒØ«Ø± Ù‚Ø±Ø§Ø¡Ø© ÙÙŠ ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯
            const dailyReadings = [];
            participants.forEach(p => {
                if (seasonOnly && p.seasonalData.has(appData.currentSeason)) {
                    // Ø­Ø³Ø§Ø¨ ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù…Ø¨Ø³Ø·)
                    const seasonHours = p.seasonalData.get(appData.currentSeason).hours;
                    const seasonDays = p.seasonalData.get(appData.currentSeason).days.size;
                    dailyReadings.push({
                        name: p.name,
                        value: Math.round((seasonHours / Math.max(1, seasonDays)) * 60) // Ø¯Ù‚Ø§Ø¦Ù‚ ÙŠÙˆÙ…ÙŠØ§Ù‹
                    });
                } else if (!seasonOnly) {
                    dailyReadings.push({
                        name: p.name,
                        value: Math.round((p.totalHours / Math.max(1, p.readingDays.size)) * 60)
                    });
                }
            });
            
            // Ø£Ø·ÙˆÙ„ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
            const streakData = participants.map(p => ({
                name: p.name,
                value: seasonOnly ? (p.currentStreak || 0) : (p.maxStreak || 0)
            }));
            
            // Ø£Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙÙƒØ§Ø±
            const ideasData = participants.map(p => ({
                name: p.name,
                value: seasonOnly ? 
                    Math.round(p.seasonalData.get(appData.currentSeason)?.ideas || 0) : 
                    Math.round(p.totalIdeas)
            }));
            
            return {
                dailyReading: dailyReadings.sort((a, b) => b.value - a.value).slice(0, 3),
                longestStreak: streakData.sort((a, b) => b.value - a.value).slice(0, 3),
                totalIdeas: ideasData.sort((a, b) => b.value - a.value).slice(0, 3)
            };
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©
        function displayRecords(containerId, records) {
            const container = document.getElementById(containerId);
            if (!container || !records.dailyReading) return;
            
            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
            
            let html = '';
            
            // Ø£ÙƒØ«Ø± Ù‚Ø±Ø§Ø¡Ø© ÙÙŠ ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯
            html += '<h4>ğŸ“– Ø£ÙƒØ«Ø± Ù‚Ø±Ø§Ø¡Ø© ÙŠÙˆÙ…ÙŠØ©</h4>';
            records.dailyReading.forEach((record, index) => {
                html += `
                    <div class="record-item">
                        <div>
                            <span class="medal">${medals[index]}</span>
                            ${record.name}
                        </div>
                        <div><strong>${record.value}</strong> Ø¯Ù‚ÙŠÙ‚Ø©/ÙŠÙˆÙ…</div>
                    </div>
                `;
            });
            
            // Ø£Ø·ÙˆÙ„ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
            html += '<h4 style="margin-top: 25px;">ğŸ”¥ Ø£Ø·ÙˆÙ„ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©</h4>';
            records.longestStreak.forEach((record, index) => {
                html += `
                    <div class="record-item">
                        <div>
                            <span class="medal">${medals[index]}</span>
                            ${record.name}
                        </div>
                        <div><strong>${record.value}</strong> ÙŠÙˆÙ…</div>
                    </div>
                `;
            });
            
            // Ø£Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙÙƒØ§Ø±
            html += '<h4 style="margin-top: 25px;">ğŸ’¡ Ø£Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙÙƒØ§Ø±</h4>';
            records.totalIdeas.forEach((record, index) => {
                html += `
                    <div class="record-item">
                        <div>
                            <span class="medal">${medals[index]}</span>
                            ${record.name}
                        </div>
                        <div><strong>${record.value}</strong> ÙÙƒØ±Ø©</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
        function updateOverallResults() {
            const allParticipants = Array.from(appData.participants.values())
                .sort((a, b) => b.totalIdeas - a.totalIdeas);
            
            // Ø±Ø³Ù… Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
            createOverallChart('overall-chart', allParticipants.slice(0, 10));
            
            // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
            displayOverallParticipants('overall-participants-list', allParticipants);
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
        function createOverallChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            if (ctx.chart) {
                ctx.chart.destroy();
            }
            
            ctx.chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(p => p.name),
                    datasets: [{
                        label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙÙƒØ§Ø±',
                        data: data.map(p => Math.round(p.totalIdeas)),
                        backgroundColor: 'rgba(104, 121, 227, 0.8)',
                        borderColor: 'rgba(117, 79, 167, 1)',
                        borderWidth: 2,
                        borderRadius: 8,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: 'white'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.2)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'white'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.2)'
                            }
                        }
                    }
                }
            });
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
        function displayOverallParticipants(containerId, participants) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '';
            
            participants.forEach((participant, index) => {
                const seasonsParticipated = participant.seasonalData.size;
                
                html += `
                    <div class="participant-card">
                        <div class="participant-header">
                            <div class="participant-name">${participant.name}</div>
                            <div class="participant-rank">#${index + 1}</div>
                        </div>
                        <div class="participant-stats">
                            <div class="stat-item">
                                <span class="stat-value">${Math.round(participant.totalIdeas)}</span>
                                <span class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙÙƒØ§Ø±</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${Math.round(participant.totalHours * 10) / 10}</span>
                                <span class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${participant.maxStreak || 0}</span>
                                <span class="stat-title">Ø£Ø·ÙˆÙ„ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${seasonsParticipated}</span>
                                <span class="stat-title">Ø§Ù„Ù…ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${participant.readingDays.size}</span>
                                <span class="stat-title">Ø£ÙŠØ§Ù… Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${Math.round((participant.totalIdeas / seasonsParticipated) * 10) / 10}</span>
                                <span class="stat-title">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø£ÙÙƒØ§Ø±/Ù…ÙˆØ³Ù…</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<div class="error">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</div>';
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
        function showPage(pageId) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            event.target.classList.add('active');
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ØªÙ… ØªØ­Ù…ÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¶Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
            fetchData();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
            setInterval(fetchData, 5 * 60 * 1000);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                    showPage(pageId);
                });
            });
        });

        // Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªÙØ§Ø¹Ù„
        window.showPage = showPage;
        
        // ØªØ´Ø®ÙŠØµ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        window.debugApp = function() {
            console.log('ğŸ“Š Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:', appData);
            console.log('ğŸ‘¥ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†:', Array.from(appData.participants.entries()));
            console.log('ğŸ• Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:', appData.lastUpdate);
        };
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹
        window.refreshData = function() {
            fetchData();
        };
    </script>
</body>
</html>